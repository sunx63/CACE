# CACE
The method is to estimate the CACE of a multisite randomized trial with binary outcomes and incomplete compliances by fitting a random coefficient model and estimating via ML approach.

The scripts are functioalized. There are four desmonstration scripts uploaded to the repository. Script r1_q4_n40_x1x2_potential.R is for simulating a dataset of a multisite study with cluster size of 40 and 170 sites, and both potential outcomes and complete compliances, and estimating the average treatment effect by lme4 package. This is to show the gold standard of estimating treatment effect with potential outcomes. The simulation function in the script can generate a dataset with potential or observed outcomes as shown in comments (L2 is for a dataset with potential outcomes and L1o is a set with observed outcomes). Script r1_q4_n80_J65_x1x2_my05.R is for simulating a dataset of a multisite study with cluster size of 80, 65 sites and 5% missing rate in outcomes, and estimating the average treatment effect with our method with one random effect sharing. Script r1_q4_eassist_x1x2_temp.R is for simulating a dataset of e-assist sample size with an average sample size of 11 and 170 physicians. The treatment effect is estimated with one random effect shared among three compliance groups and 4 abscissas. Script r3_q4_n40_J170_x1x2_my0.R is for simulating a dataset of a multisite study with cluster size of 40, 170 sites and outcomes completely observed, and estimating the average treatment effect with our method with no random effect sharing. 

Users need to download all functional scripts and modify any main script according to your dataset and needs and run the scripts. The function in script cace_1side_parallel_lambda.R is the major function for CACE estimation with shared random effects. The function in script cace_1side_parallel.R is the major function for CACE estimation without shared random effects. The function in script set_init.R generates the initial values of all parameters when there is a or two shared random effect(s) (r=1 or 2), while the function in script set_init_noshare.R for generates the initial values of all parameters when there is no random effect sharing (r=3). The functions in the rest of the scripts can be used with or without shared random effect (r=1, 2 or 3). 

For successful running of functions cace_1side_parallel() and cace_1side_parallel_lambda(), the datasets must contain cluster ID, treatment assignment (0=assigned to control or 1=assigned to treatment), treatment receipt (0=receiving control or 1=receiving treatment) and outcome variables (0 or 1). The cluster ID, treatment assignment and receipt variables must be completely observed. The outcome variable may be completely observed or missing at random. The function can handle the missing outcomes MAR.


